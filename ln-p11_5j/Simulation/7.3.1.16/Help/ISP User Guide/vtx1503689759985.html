
<!DOCTYPE html
  PUBLIC "" "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="description" content="Before tuning the ABF module, determine how many lighting regions to define and create them in the Parameter Editor. Regular 2D convolution filtering deteriorates image quality, particularly when ..." /><meta name="copyright" content="(C) Copyright 2019" /><meta name="DC.rights.owner" content="(C) Copyright 2019" /><meta name="DC.Type" content="task" /><meta name="DC.Title" content="Tune ABF" /><meta name="DC.Relation" scheme="URI" content="kok1494872095058.html" /><meta name="DC.Relation" scheme="URI" content="qnq1499365175979.html" /><meta name="DC.Relation" scheme="URI" content="nsh1499457051373.html" /><meta name="documenttype" content="Tuning Guide" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="vtx1503689759985" /><meta name="DC.Language" content="en-us" /><link rel="stylesheet" type="text/css" href="oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>Tune ABF</title><!--  Generated with Oxygen version 17.1, build number 2016020417.  --><link rel="stylesheet" type="text/css" href="oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="oxygen-webhelp/resources/skins/skin.css"><!----></link><script type="text/javascript"><!--
          
          var prefix = "index.html";
          
          --></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery-1.8.2.min.js"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script></head>
<body onload="highlightSearchTerm()" class="frmBody" id="vtx1503689759985">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><a href="javascript:window.print();" title="Print this page"></a></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td width="75%"><a class="navheader_parent_path" href="adl1504650516665.html" title="IFE tuning">IFE tuning</a> / <a class="navheader_parent_path" href="kok1494872095058.html" title="ABF tuning concepts">ABF tuning concepts</a></td><td><div class="navheader">
<span class="navparent"><a class="link" href="kok1494872095058.html" title="ABF tuning concepts"><span class="navheader_label">Parent Topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">ABF tuning concepts</span></a></span>  </div></td></tr></tbody></table>
	<h1 class="title topictitle1" id="ariaid-title1">Tune ABF </h1>

	<div class="body taskbody">
		<div class="section prereq p" id="vtx1503689759985__prereq_N10015_N10012_N10001">
			<p class="p">Before tuning the ABF module, determine how many lighting regions to define and
				create them in the Parameter Editor. </p>

		</div>

		<div class="section context" id="vtx1503689759985__context_N100E5_N10014_N10001">Regular 2D convolution filtering
			deteriorates image quality, particularly when applied on Bayer pixels. To reduce the
			noise without blurring sharp edges, use an adaptive Bayer filter (ABF), which can adapt
			its kernel based on neighboring pixel values.</div>

		<ol class="ol steps" id="vtx1503689759985__steps_7FE4967F02BA4A5B82EBF4D09B7CE136"><li class="li step stepexpand" id="vtx1503689759985__step_C314EB42C91C463F9EE0E1DD448C5821">
				<span class="ph cmd">On the <span class="ph uicontrol">Pipeline</span> tab,
					click <span class="ph menucascade"><span class="ph uicontrol">IFE</span> &gt; <span class="ph uicontrol">ABF</span></span>. </span>
			</li>
<li class="li step stepexpand" id="vtx1503689759985__step_N10048_N1002F_N10015_N10001">
				<span class="ph cmd">Calibrate the noise profile as follows: </span>
				<ol type="a" class="ol substeps" id="vtx1503689759985__substeps_cpn_csl_p1b">
					<li class="li substep">
						<span class="ph cmd" id="vtx1503689759985__ID-64-00000652">Click a region and click the
								<span class="ph uicontrol">Load Image</span> button. </span>
					</li>

					<li class="li substep">
						<span class="ph cmd">Select a raw image of an MCC chart taken in the
							appropriate lighting condition for that region.</span>
					</li>

					<li class="li substep">
						<span class="ph cmd">Set the MCC markers. Drag the top-left MCC grid marker
							to the center of the top-left color patch and drag the bottom-right MCC
							grid marker to the center of the bottom right color patch, to align all
							of the grid markers within the color patches. <strong class="ph b">Note</strong>: If the image
							is taken with a fisheye lens, to set the MCC markers for tuning, hold
							the Ctrl Key (or Shift Key) while moving the markers.</span>
					</li>

					<li class="li substep">
						<span class="ph cmd">Click <span class="ph uicontrol">Calculate</span>
							to compute the noise profile. View the resulting noise profile graph on
							the <span class="ph uicontrol">Noise Profile</span> tab.</span>
					</li>

				</ol>

			</li>
<li class="li step stepexpand" id="vtx1503689759985__step_N101E9_N100EC_N10014_N10001">
				<span class="ph cmd">Calibrate the radial noise reduction. Click the <span class="ph uicontrol">Sigma LUT RNR</span> button and do the following
					steps: </span>
				<ol type="a" class="ol substeps" id="vtx1503689759985__substeps_nvs_pfb_41b">
					<li class="li substep">
						<span class="ph cmd">Click the <span class="ph uicontrol">Sigma LUT</span> tab and open
							a gray chart raw image for the appropriate lighting region.  <br /><img class="image" id="vtx1503689759985__image_tjy_md2_p1b" src="epi1500401874056.png" /><br /></span>
					</li>

					<li class="li substep">
						<span class="ph cmd">Click <span class="ph uicontrol">Calculate</span> to generate the
							Sigma LUT plot.</span>
					</li>

					<li class="li substep">
						<span class="ph cmd">Click the <span class="ph uicontrol">RNR Control
								Points</span> tab, and adjust the <span class="ph uicontrol">Radial Percentage</span> slider to set the second control
							point. The tool computes the other points automatically. <br /><img class="image" id="vtx1503689759985__image_pnb_d22_p1b" src="vpm1500402152533.png" /><br /></span>
					</li>

					<li class="li substep">
						<span class="ph cmd">Click <span class="ph uicontrol">Close</span>.</span>
					</li>

				</ol>

			</li>
<li class="li step stepexpand" id="vtx1503689759985__step_N100F2_N1002F_N10015_N10001">
				<span class="ph cmd">(Optional) ABF processing is enabled by default. To disable ABF processing,
					open the Parameter Editor, navigate to <span class="ph menucascade"><span class="ph uicontrol">ABF 34 IFE </span> &gt; <span class="ph uicontrol">Enable Section</span> &gt; <span class="ph uicontrol">ABF Enable</span></span>, and change the value from 1 to 0.</span>
			</li>
<li class="li step stepexpand" id="vtx1503689759985__step_N1010E_N1002F_N10015_N10001">
				<span class="ph cmd">(Optional) Single BPC is disabled by default (and full BPC is on). To turn off
					full BPC, open the Parameter Editor, navigate to <span class="ph menucascade"><span class="ph uicontrol">ABF 34 IFE </span> &gt; <span class="ph uicontrol">Enable Section</span> &gt; <span class="ph uicontrol">Sbpc Enable</span></span>, and change the value from 0 to 1.</span>
			</li>
<li class="li step stepexpand" id="vtx1503689759985__step_N100DA_N1002F_N10015_N10001">
				<span class="ph cmd">(Optional) Gr/Gb cross-channel processing is enabled by
					default. To disable cross-channel processing, open the Parameter Editor,
					navigate to <span class="ph menucascade"><span class="ph uicontrol">ABF 34 IFE </span> &gt; <span class="ph uicontrol">ABF 34 Reserve</span> &gt; <span class="ph uicontrol">Cross Plane En</span></span>, and change the value from 1 to 0.</span>
			</li>
<li class="li step stepexpand" id="vtx1503689759985__step_N10098_N1002F_N10015_N10001">
				<span class="ph cmd">As needed, click the <span class="ph uicontrol">Region
						Data</span> tab and tune the following ABF parameters: </span>
				<div class="itemgroup info">
					
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="vtx1503689759985__table_bb2_5ln_bbb" class="table" frame="border" border="1" rules="all"><colgroup><col /><col /></colgroup><thead class="thead" style="text-align:left;">
								<tr class="row">
									<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d34795e223">Parameter</th>

									<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d34795e226">Description</th>

								</tr>

							</thead>
<tbody class="tbody">
								<tr class="row">
									<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d34795e223 ">Edge Softness</td>

									<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d34795e226 ">Works with the noise profile to control bilateral filter strength.
										One value controls all four channels.</td>

								</tr>

								<tr class="row">
									<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d34795e223 ">Noise Prsv Lo and Noise Prsv Hi</td>

									<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d34795e226 ">Minimum and maximum values for how much noise to retain. Helps to
										remove dark artifacts.</td>

								</tr>

								<tr class="row">
									<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d34795e223 ">Noise Prsv Anchor Lo and Noise Prsv Anchor Hi</td>

									<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d34795e226 ">Controls minimum and maximum thresholds for local
										intensity.</td>

								</tr>

								<tr class="row">
									<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d34795e223 ">Blk Pix Matching Rb and Blk Pix Matching G</td>

									<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d34795e226 ">Controls the weighted average of block matching vs. pixel
										matching.</td>

								</tr>

								<tr class="row">
									<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d34795e223 ">Distance Kernel</td>

									<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d34795e226 ">Entries [0] - [2] control distance weight for the RB channels and
										entries [3] - [5] control distance weight for the GrGb
										channels</td>

								</tr>

								<tr class="row">
									<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d34795e223 ">Curve Offset</td>

									<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d34795e226 ">Smooths out details and noise for each channel.</td>

								</tr>

								<tr class="row">
									<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d34795e223 ">Radial Gain parameters</td>

									<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d34795e226 ">Entries [0] - [4] adjust edge softness and entries [5] - [9] adjust
										noise preservation.</td>

								</tr>

							</tbody>
</table>
</div>

				</div>
			</li>
<li class="li step stepexpand" id="vtx1503689759985__step_N101B8_N1002F_N10015_N10001">
				<span class="ph cmd">Repeat all steps for each lighting region you set up.</span>
			</li>
<li class="li step stepexpand" id="vtx1503689759985__step_N1020C_N1002F_N10015_N10001">
				<span class="ph cmd">(Optional) To see the results of the tuning adjustments, click
						<span class="ph uicontrol">Simulate</span>. Otherwise, simulate after the entire
					pipeline is tuned.</span>
			</li>
<li class="li step stepexpand" id="vtx1503689759985__step_N101DD_N1002F_N10015_N10001">
				<span class="ph cmd">To save the changes, click <span class="ph menucascade"><span class="ph uicontrol">File</span> &gt; <span class="ph uicontrol">Save To Project</span></span>. </span>
			</li>
</ol>

	</div>

<div class="related-links">
<div class="linklist linklist relinfo"><strong>Related Information</strong><br />

<div class="related_link"><a class="navheader_parent_path" href="nsh1499457051373.html" title="ABF Parameters">ABF Parameters</a></div></div>

<div class="linklist linklist relinfo"><strong>Related Tasks</strong><br />

<div class="related_link"><a class="navheader_parent_path" href="qnq1499365175979.html" title="A region is a set of triggers that are indicative of light conditions, lens positions or other conditions as applicable to a given module. A project which is created with the build XSD and XML files has only one region for each module. Chromatix 7 gives the flexibility to create multiple regions for an ISP module. Adding regions to the module enables to optimize camera performance based on the established triggers for each region. Add regions to the pipeline before tuning the ISP and before adding modes to the project.">Add and edit region triggers</a></div></div>
</div><div class="navfooter"><!---->
<span class="navparent"><a class="link" href="kok1494872095058.html" title="ABF tuning concepts"><span class="navheader_label">Parent Topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">ABF tuning concepts</span></a></span>  </div><div class="footer"><table><col width="30%" /><col width="40%" /><col width="30%" /><tr><td class="Qualcommfooter" rowspan="2" align="left">80-NK872-13</td><td class="Qualcommfooter" align="center">Confidential and Proprietary – Qualcomm Technologies, Inc.</td><td></td></tr><tr><td class="Qualcommfooter" align="center"><b>MAY CONTAIN U.S. AND INTERNATIONAL EXPORT CONTROLLED INFORMATION</b></td><td align="right"></td></tr></table></div></body>
</html>

<!DOCTYPE html
  PUBLIC "" "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="description" content="In general, PDAF monitors the scene for changes and triggers a search if the following conditions are met: The defocus value of the current frame is greater than the defocus threshold The algorithm is ..." /><meta name="copyright" content="(C) Copyright 2019" /><meta name="DC.rights.owner" content="(C) Copyright 2019" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="PDAF monitor: defocused, confident, and stable" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="cbt1477085276016" /><meta name="DC.Language" content="en-us" /><link rel="stylesheet" type="text/css" href="oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>PDAF monitor: defocused, confident, and stable</title><!--  Generated with Oxygen version 17.1, build number 2016020417.  --><link rel="stylesheet" type="text/css" href="oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="oxygen-webhelp/resources/skins/skin.css"><!----></link><script type="text/javascript"><!--
          
          var prefix = "index.html";
          
          --></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery-1.8.2.min.js"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script></head>
<body onload="highlightSearchTerm()" class="frmBody" id="cbt1477085276016">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><a href="javascript:window.print();" title="Print this page"></a></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td width="75%"></td><td><div class="navheader"></div></td></tr></tbody></table>
   <h1 class="title topictitle1" id="ariaid-title1">PDAF monitor: defocused, confident, and stable</h1>

   <div class="body conbody">
      <p class="p">In general, PDAF monitors the scene for changes and triggers a search if the following conditions are met:</p>

      <ul class="ul">
         <li class="li">The defocus value of the current frame is greater than the defocus threshold</li>

         <li class="li">The algorithm is confident</li>

         <li class="li">The scene is stable</li>

      </ul>

      <p class="p">If these conditions are met, then PDAF triggers a search. If not, then PDAF continues monitoring the scene or, in some conditions, switches to contrast AF.</p>

      <div class="section" id="cbt1477085276016__section_N10029_N1000E_N10001"><h2 class="title sectiontitle">Defocus</h2><p class="p">The phase difference is computed and converted to a defocus value to indicate the size and direction of the lens movement required to achieve focus. A positive defocus value means that the movement is from near to far. A negative defocus value means that the movement is from far to near. When the defocus value is close to zero, it means that the target is in focus.</p>
<p class="p">The defocus value is calculated as follows:</p>
<pre class="pre codeblock"><code>AF defocus value (um) = &#8232;Final PD value (pixel) * DCC (DAC/pixel) * VCM Sensitivity (um/DAC)</code></pre><ul class="ul">
            <li class="li"><span class="ph uicontrol">Final PD value</span> – Weighted average of each ROI PD and confidence value, including only the ROIs with a confidence value larger than minimum confidence threshold.</li>

            <li class="li"><span class="ph uicontrol">DCC</span> – Defocus conversion coefficient calibrated by the module vendor.</li>

            <li class="li"><span class="ph uicontrol">VCM sensitivity</span> – AF calibration result from the module vendor.</li>

         </ul>
</div>

      <div class="section" id="cbt1477085276016__section_N10052_N1000E_N10001"><h2 class="title sectiontitle">Confident</h2><p class="p">The confidence level is a function of the number of clues (e.g., vertical edges, scene brightness) in the scene that is used in the phase difference estimation. A high confidence means that the PD in the ROI has a small variance and a higher edge intensity. The confidence table is used to define a minimum confidence threshold relative to the sensor gain.</p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="cbt1477085276016__ID-table-00000007" class="table" frame="void" border="1" rules="all"><colgroup><col style="width:3.247in" /><col style="width:2.747in" /></colgroup><tbody class="tbody">
                  <tr class="row">
                     <td class="entry nocellnorowborder" style="text-align:center;vertical-align:top;"><img class="image" id="cbt1477085276016__image_ngm_bbl_rx" src="bue1495660786567.png" height="190" width="338" /></td>

                     <td class="entry nocellnorowborder" style="text-align:center;vertical-align:top;"><img class="image" id="cbt1477085276016__image_pdw_cbl_rx" src="dyq1495660856658.png" height="188" width="252" /></td>

                  </tr>

                  <tr class="row">
                     <td class="entry nocellnorowborder" style="text-align:center;vertical-align:top;"><strong class="ph b">High confidence:
                           bright scene and multiple &#8232;vertical edges</strong></td>

                     <td class="entry nocellnorowborder" style="text-align:center;vertical-align:top;"><strong class="ph b">Lower confidence:
                           low-light scene and few vertical edges</strong></td>

                  </tr>

               </tbody>
</table>
</div>
</div>

      <div class="section" id="cbt1477085276016__section_N100AC_N1000E_N10001"><h2 class="title sectiontitle">Stable</h2><p class="p">The stability is calculated by evaluating the defocus value history. If the values are within a tunable threshold, then the scene is considered stable.</p>
</div>

   </div>

<div class="navfooter"><!----></div><div class="footer"><table><col width="30%" /><col width="40%" /><col width="30%" /><tr><td class="Qualcommfooter" rowspan="2" align="left">80-NK872-14</td><td class="Qualcommfooter" align="center">Confidential and Proprietary – Qualcomm Technologies, Inc.</td><td></td></tr><tr><td class="Qualcommfooter" align="center"><b>MAY CONTAIN U.S. AND INTERNATIONAL EXPORT CONTROLLED INFORMATION</b></td><td align="right"></td></tr></table></div></body>
</html>